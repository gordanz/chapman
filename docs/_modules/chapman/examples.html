
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>chapman.examples &#8212; chapman 0.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for chapman.examples</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">networkx.drawing.nx_agraph</span> <span class="kn">import</span> <span class="n">graphviz_layout</span> 
<span class="kn">from</span> <span class="nn">chapman.base</span> <span class="kn">import</span> <span class="n">MarkovChain</span>


<span class="k">def</span> <span class="nf">_good_function</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">func_name</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>  <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">and</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmodule</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="o">==</span> <span class="n">mod</span> <span class="ow">and</span>
<span class="ow">not</span> <span class="n">func_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">func_name</span> <span class="o">==</span> <span class="s2">&quot;list_examples&quot;</span> <span class="p">)</span>

<div class="viewcode-block" id="list_examples"><a class="viewcode-back" href="../../chapman.html#chapman.examples.list_examples">[docs]</a><span class="k">def</span> <span class="nf">list_examples</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Prints out the names of all  currently implemented examples.&quot;&quot;&quot;</span>

    <span class="n">this_module</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span> 
    <span class="n">dct</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">this_module</span><span class="p">)</span>
    <span class="n">good</span> <span class="o">=</span> <span class="p">[</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dct</span> <span class="k">if</span> <span class="n">_good_function</span><span class="p">(</span><span class="n">this_module</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">good</span><span class="p">))</span></div>

<span class="k">def</span> <span class="nf">_rst</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper for rotate_scale_translate&quot;&quot;&quot;</span>

    <span class="n">PI_OVER_180</span> <span class="o">=</span> <span class="mf">0.0174533</span>
    <span class="n">cosa</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">PI_OVER_180</span><span class="p">)</span>
    <span class="n">sina</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">PI_OVER_180</span><span class="p">)</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">sx</span><span class="o">*</span><span class="p">(</span><span class="n">cosa</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sina</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">dx</span>
    <span class="n">yp</span> <span class="o">=</span> <span class="n">sy</span><span class="o">*</span><span class="p">(</span><span class="n">sina</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">cosa</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">dy</span>
    <span class="k">return</span><span class="p">([</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">_rotate_scale_translate</span><span class="p">(</span><span class="n">point_dict</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stretch_x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
        <span class="n">stretch_y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">move_x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">move_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Applies an affine transformation to a layout dictionary </span>
<span class="sd">    for a Markov chain</span>

<span class="sd">    args:</span>
<span class="sd">        point_dict (dict): dictionary of states to positions [x,y]</span>
<span class="sd">        angle (float, optional) : angle of rotation</span>
<span class="sd">        stretch_x(float, optional) : stretch factor in x, defaults to 1</span>
<span class="sd">        stretch_y(float, optional) : stretch factor in y, defaults to 1</span>
<span class="sd">        move_x(float, optional) : translation in x, defaults to 1</span>
<span class="sd">        move_y(float, optional) : translation in y, defaults to 0</span>

<span class="sd">    Returns:</span>
<span class="sd">        a layout dictionary (dict of positions [x,y,z,...] with z, ...</span>
<span class="sd">        discarded)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span><span class="p">(</span> <span class="p">{</span> <span class="n">k</span><span class="p">:</span><span class="n">_rst</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">stretch_x</span><span class="p">,</span> <span class="n">stretch_y</span><span class="p">,</span> <span class="n">move_x</span><span class="p">,</span> <span class="n">move_y</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">point_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">_curve_doubles</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;If there are edged going both ways between two states, curve</span>
<span class="sd">    them.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        m (MarkovChain): the chain</span>
<span class="sd">        curve (float): the amount of curvature (default = 0.15)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">states</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">states</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">m</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="n">s1</span><span class="p">):</span>
                <span class="n">m</span><span class="o">.</span><span class="n">set_curve</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">curve</span><span class="p">)</span>
                <span class="n">m</span><span class="o">.</span><span class="n">set_curve</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">curve</span><span class="p">)</span>

<div class="viewcode-block" id="random_walk"><a class="viewcode-back" href="../../chapman.html#chapman.examples.random_walk">[docs]</a><span class="k">def</span> <span class="nf">random_walk</span><span class="p">(</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">reflecting</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Random walk as a Markov chain. T is the time horizon, p is the</span>
<span class="sd">    probability of &#39;&#39;up&#39;&#39;. States are {-T,-T-1,..., T-1, T}.</span>
<span class="sd">    If reflecting is True, both boundaries T and -T are reflective,</span>
<span class="sd">    otherwise they are absorbing.</span>

<span class="sd">    Args:</span>
<span class="sd">        T (int): time horizon (default 4)</span>
<span class="sd">        p (float): the probability of an up-step (default 0.5)</span>
<span class="sd">        reflecting (bool): boundary behavior</span>

<span class="sd">    Returns:</span>
<span class="sd">        a MarkoChain object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Must have T&gt;0, p in (0,1)&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">p</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">MarkovChain</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Random_walk&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">probability</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span>
                <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">probability</span> <span class="o">=</span> <span class="n">q</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;q&quot;</span><span class="p">,</span>
                <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reflecting</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">probability</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">probability</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="p">))</span>
        <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="s2">&quot;u&quot;</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="p">),</span> <span class="s2">&quot;u&quot;</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="mi">70</span><span class="o">*</span><span class="n">T</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="attached_cycles"><a class="viewcode-back" href="../../chapman.html#chapman.examples.attached_cycles">[docs]</a><span class="k">def</span> <span class="nf">attached_cycles</span><span class="p">(</span><span class="n">n1</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">pA</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Markov chain with two attached cycles and a tail.</span>

<span class="sd">    Args:</span>
<span class="sd">        n1 (int) : size of the first cycle</span>
<span class="sd">        n2 (int) : size of the second cycle</span>
<span class="sd">        pA (float) : probability of choosing the first cycle</span>
<span class="sd">        tail (bool) : whether to add a tail to the chain</span>

<span class="sd">    Returns: </span>
<span class="sd">        a MarkovChain object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">n1</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">n2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> \
            <span class="s2">&quot;Cycles need to be at least 2 states in length&quot;</span>
    
    <span class="n">m</span><span class="o">=</span><span class="n">MarkovChain</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Attached_Cycles&quot;</span><span class="p">)</span>

    <span class="c1"># nodes (must make them explicitly blue if you use graphviz)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s2">&quot;AB1&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n1</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;AB1&quot;</span><span class="p">,</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">probability</span> <span class="o">=</span> <span class="n">pA</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;AB1&quot;</span><span class="p">,</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="n">probability</span> <span class="o">=</span> <span class="n">pA</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span><span class="s2">&quot;AB1&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="p">),</span><span class="s2">&quot;AB1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n1</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n1</span><span class="p">):</span>
            <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;A&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">n2</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n2</span><span class="p">):</span>
            <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;B&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># adding a tail</span>
    <span class="k">if</span> <span class="n">tail</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s2">&quot;C2&quot;</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;AB1&quot;</span><span class="p">,</span><span class="s2">&quot;C2&quot;</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span><span class="s2">&quot;C2&quot;</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">set_probability</span><span class="p">(</span><span class="s2">&quot;AB1&quot;</span><span class="p">,</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span><span class="n">pA</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">set_probability</span><span class="p">(</span><span class="s2">&quot;AB1&quot;</span><span class="p">,</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span><span class="n">pA</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Layout</span>
    <span class="c1">###############</span>
    <span class="c1"># pre_layout = graphviz_layout(m.graph, prog=&quot;fdp&quot;, </span>
            <span class="c1"># args = &quot;-Gmodel=subset -Gnodesep=1.5&quot;) </span>
    <span class="n">pre_layout</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">kamada_kawai_layout</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">_rotate_scale_translate</span><span class="p">(</span><span class="n">pre_layout</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> 
            <span class="n">stretch_x</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">stretch_y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span><span class="p">,</span><span class="n">pos</span> <span class="ow">in</span> <span class="n">layout</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">m</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s2">&quot;position&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">pos</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="gambler"><a class="viewcode-back" href="../../chapman.html#chapman.examples.gambler">[docs]</a><span class="k">def</span> <span class="nf">gambler</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.25</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The chain for &quot;Gambler&#39;s ruin&quot; problem.</span>

<span class="sd">    Args: </span>
<span class="sd">        p (float): the probability of winning in a single round</span>
<span class="sd">        a (int): the goal amount</span>

<span class="sd">    Returns: </span>
<span class="sd">        a MarkovChain object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">a</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;a must be at least 3&quot;</span>
    <span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">p</span> <span class="ow">and</span> <span class="n">p</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;p must be in (0,1)&quot;</span>

    <span class="n">m</span><span class="o">=</span><span class="n">MarkovChain</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gambler&quot;</span><span class="p">)</span>

    <span class="c1"># nodes (must make them explicitly blue if you use graphviz)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>
        
    <span class="n">m</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>

    <span class="c1"># transitions</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> 
                <span class="n">probability</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">,</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;1-p&quot;</span><span class="p">,</span><span class="n">curve</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> 
                <span class="n">probability</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_curve</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_curve</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>

    <span class="c1"># Layout</span>
    <span class="c1">###############</span>

    <span class="n">m</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></div>


<span class="c1"># def mc8_1():</span>
    <span class="c1"># # &quot;&quot;&quot;The chain for problem MC8_1 </span>
    
    <span class="c1"># # Returns: a MarkovChain object</span>
    <span class="c1"># # &quot;&quot;&quot;</span>
    
    <span class="c1"># m=MarkovChain(title=&quot;MC8_1&quot;)</span>

    <span class="c1"># # nodes (must make them explicitly blue if you use graphviz)</span>
    <span class="c1"># for i in range(8):</span>
        <span class="c1"># m.add_state(str(i+1), color=&quot;blue&quot;);</span>

    <span class="c1"># # From 1</span>
    <span class="c1"># m.add_transition(&quot;1&quot;,&quot;1&quot;,probability = 0.5, label=&quot;1/2&quot;)</span>
    <span class="c1"># m.add_transition(&quot;1&quot;,&quot;2&quot;,probability = 0.5, label=&quot;1/2&quot;)</span>

    <span class="c1"># # From 2</span>
    <span class="c1"># m.add_transition(&quot;2&quot;,&quot;3&quot;,probability = 0.5, label=&quot;1/2&quot;)</span>
    <span class="c1"># m.add_transition(&quot;2&quot;,&quot;7&quot;,probability = 0.5, label=&quot;1/2&quot;)</span>

    <span class="c1"># # From 3</span>
    <span class="c1"># m.add_transition(&quot;3&quot;,&quot;4&quot;,curve = 0.2)</span>

    <span class="c1"># # From 4</span>
    <span class="c1"># m.add_transition(&quot;4&quot;,&quot;3&quot;,probability = 0.5, label=&quot;1/2&quot;,curve=0.2);</span>
    <span class="c1"># m.add_transition(&quot;4&quot;,&quot;5&quot;,probability = 0.5, label=&quot;1/2&quot;)</span>

    <span class="c1"># # From 5</span>
    <span class="c1"># m.add_transition(&quot;5&quot;,&quot;6&quot;)</span>

    <span class="c1"># # From 6</span>
    <span class="c1"># m.add_transition(&quot;6&quot;,&quot;3&quot;,probability = 0.5, label=&quot;1/2&quot;)</span>
    <span class="c1"># m.add_transition(&quot;6&quot;,&quot;6&quot;,probability = 0.5, label=&quot;1/2&quot;)</span>

    <span class="c1"># # From 7</span>
    <span class="c1"># m.add_transition(&quot;7&quot;,&quot;8&quot;,curve=0.2);</span>

    <span class="c1"># # From 5</span>
    <span class="c1"># m.add_transition(&quot;8&quot;,&quot;7&quot;,probability = 0.75, label=&quot;3/4&quot;, curve=0.2);</span>
    <span class="c1"># m.add_transition(&quot;8&quot;,&quot;8&quot;,probability = 0.25, label=&quot;1/4&quot;)</span>

    <span class="c1"># # loops</span>
    <span class="c1"># m.set_loop_direction(&quot;1&quot;,&quot;ur&quot;)</span>
    <span class="c1"># m.set_loop_direction(&quot;8&quot;,&quot;ur&quot;)</span>
    <span class="c1"># m.set_loop_direction(&quot;6&quot;,&quot;ur&quot;)</span>

    <span class="c1"># # Layout</span>
    <span class="c1"># ###############</span>
    <span class="c1"># pre_layout = graphviz_layout(m, prog=&quot;fdp&quot;, </span>
            <span class="c1"># args = &quot;-Gmodel=subset -Gnodesep=1.5&quot;) </span>
    <span class="c1"># layout = _rotate_scale_translate(pre_layout, angle = -90, </span>
            <span class="c1"># stretch_x = 2, stretch_y = 2)</span>
    <span class="c1"># m.set_layout(layout)</span>
    <span class="c1"># m.set_canvas(180,150)</span>
    <span class="c1"># m.compute()</span>
    <span class="c1"># return(m)</span>

<span class="c1"># def facility(p=0.4):</span>
    <span class="c1"># &quot;&quot;&quot;The chain for problem about the airline reservation system and its</span>
    <span class="c1"># computers which get repaired</span>
    
    <span class="c1"># Args: </span>
        <span class="c1"># p (float): the probability of a computer breakdown</span>

    <span class="c1"># Returns: </span>
        <span class="c1"># a MarkovChain object</span>
    <span class="c1"># &quot;&quot;&quot;</span>

    <span class="c1"># m = MarkovChain(title = &quot;MC14-1&quot;)</span>

    <span class="c1"># # states</span>
    <span class="c1"># m.add_state(&quot;0-0-1-1&quot;, shape = 1);</span>
    <span class="c1"># m.add_state(&quot;2-0-0-0&quot;, shape = 1);</span>
    <span class="c1"># m.add_state(&quot;1-1-0-0&quot;, shape = 1);</span>
    <span class="c1"># m.add_state(&quot;0-1-0-1&quot;, shape = 1);</span>
    <span class="c1"># m.add_state(&quot;1-0-1-0&quot;, shape = 1);</span>
    
    <span class="c1"># # edges</span>
    <span class="c1"># m.add_transition(&quot;0-0-1-1&quot;,&quot;0-1-0-1&quot;,</span>
            <span class="c1"># label=&quot;1&quot;, probability = 1)</span>
    <span class="c1"># m.add_transition(&quot;2-0-0-0&quot;,&quot;0-0-1-1&quot;,</span>
            <span class="c1"># label=&quot;p^2&quot;, probability = p**2 )</span>
    <span class="c1"># m.add_transition(&quot;2-0-0-0&quot;,&quot;2-0-0-0&quot;,</span>
            <span class="c1"># label=&quot;(1-p)^2&quot;, probability = (1-p)**2)</span>
    <span class="c1"># m.add_transition(&quot;2-0-0-0&quot;,&quot;1-0-1-0&quot;,</span>
            <span class="c1"># label=&quot;2p(1-p)&quot;, probability = 2* p*(1-p) )</span>
    <span class="c1"># m.add_transition(&quot;1-1-0-0&quot;,&quot;2-0-0-0&quot;,</span>
            <span class="c1"># label=&quot;1-p&quot;, probability = (1-p) )</span>
    <span class="c1"># m.add_transition(&quot;1-1-0-0&quot;,&quot;1-0-1-0&quot;,</span>
            <span class="c1"># label=&quot;p&quot;,curve=0.2, probability = p)</span>
    <span class="c1"># m.add_transition(&quot;1-0-1-0&quot;,&quot;1-1-0-0&quot;,</span>
            <span class="c1"># label=&quot;1-p&quot;,curve=0.2, probability = (1-p) )</span>
    <span class="c1"># m.add_transition(&quot;1-0-1-0&quot;,&quot;0-1-0-1&quot;,</span>
            <span class="c1"># label=&quot;p&quot;,curve=0.2, probability = p )</span>
    <span class="c1"># m.add_transition(&quot;0-1-0-1&quot;,&quot;1-0-1-0&quot;,</span>
            <span class="c1"># label=&quot;1&quot;,curve=0.2, probability = 1 )</span>
    
    <span class="c1"># # loops</span>
    <span class="c1"># m.set_loop_direction(&quot;2-0-0-0&quot;,&quot;d&quot;)</span>
    
    <span class="c1"># # Layout</span>
    <span class="c1"># pre_layout =  nx.kamada_kawai_layout(m, weight = 1)</span>
    <span class="c1"># layout = _rotate_scale_translate(pre_layout, angle = -80)</span>
    <span class="c1"># m.set_layout(layout)</span>
    <span class="c1"># m.compute()</span>
    <span class="c1"># return(m)</span>

<span class="c1"># def mc20_1():</span>
    <span class="c1"># # &quot;&quot;&quot;The chain for problem MC20_1.&quot;&quot;&quot;</span>
    
    <span class="c1"># m = MarkovChain(title=&quot;MC20_1&quot;)</span>
    <span class="c1"># g = m</span>

    <span class="c1"># m.set_canvas(140,130)</span>

    <span class="c1"># # nodes</span>
    <span class="c1"># for i in range(7):</span>
        <span class="c1"># m.add_state(str(i))</span>

    <span class="c1"># the_transitions = {</span>
            <span class="c1"># (1,2,1,&quot;1&quot;),</span>
            <span class="c1"># (2,3,1,&quot;1&quot;),</span>
            <span class="c1"># (3,4,1,&quot;1&quot;),</span>
            <span class="c1"># (4,5,1,&quot;1&quot;),</span>
            <span class="c1"># (5,1,1,&quot;1&quot;),</span>
            <span class="c1"># (0,1,0.5,&quot;1/2&quot;),</span>
            <span class="c1"># (0,6,0.5,&quot;1/2&quot;),</span>
            <span class="c1"># (6,6,1,&quot;1&quot;)</span>
            <span class="c1"># }</span>

    <span class="c1"># for (i1,i2,p,l) in the_transitions:</span>
        <span class="c1"># m.add_transition(str(i1), str(i2), probability = p, label = l)</span>

    <span class="c1"># # pre_layout =  nx.kamada_kawai_layout(g, weight = 1)</span>
    <span class="c1"># pre_layout = graphviz_layout(g, prog=&quot;neato&quot;, args = &quot;-Gnodesep=1.5&quot;) </span>
    <span class="c1"># layout = _rotate_scale_translate(pre_layout, angle = -90, stretch_x = 20, </span>
            <span class="c1"># stretch_y = 20)</span>
    <span class="c1"># m.set_layout(layout)</span>
    <span class="c1"># # m.compute()</span>
    <span class="c1"># return(m)</span>


<span class="c1"># def mc21_1():</span>
    <span class="c1"># # &quot;&quot;&quot;The chain for problem MC21_1</span>
    
    <span class="c1"># # Returns: a MarkovChain object</span>
    <span class="c1"># # &quot;&quot;&quot;</span>

    <span class="c1"># m = Markov(title=&quot;MC21_1&quot;)</span>
    <span class="c1"># g = m</span>
   
    <span class="c1"># # states</span>
    <span class="c1"># for state in range(1,3+1):</span>
        <span class="c1"># m.add_state(str(state))</span>
   
    <span class="c1"># # transitions</span>
    <span class="c1"># m.add_transition( &quot;1&quot;,&quot;2&quot;, probability = 1, label = &quot;1&quot;, curve = 0.1)</span>
    <span class="c1"># m.add_transition( &quot;2&quot;,&quot;1&quot;, probability = 0.25, label = &quot;1/4&quot;, curve = 0.1)</span>
    <span class="c1"># m.add_transition( &quot;2&quot;,&quot;2&quot;, probability = 0.50, label = &quot;1/2&quot;)</span>
    <span class="c1"># m.add_transition( &quot;2&quot;,&quot;3&quot;, probability = 0.25, label = &quot;1/4&quot;)</span>
    <span class="c1"># m.add_transition( &quot;3&quot;,&quot;3&quot;, probability = 1, label = &quot;1&quot;, color=&quot;orange&quot;)</span>
   
    <span class="c1"># # loop directions</span>
    <span class="c1"># m.set_loop_direction(&quot;2&quot;,&quot;d&quot;)</span>
    <span class="c1"># m.set_loop_direction(&quot;3&quot;,&quot;d&quot;)</span>
    
    <span class="c1"># # the layout</span>
    <span class="c1"># pre_layout = graphviz_layout(g, prog=&quot;dot&quot;, args = &quot;-GNodesep=1&quot;)</span>
    <span class="c1"># the_layout = _rotate_scale_translate(pre_layout, angle = 90)</span>
    <span class="c1"># m.set_layout(the_layout)</span>
    <span class="c1"># m.compute()</span>
    <span class="c1"># return(m)</span>

<div class="viewcode-block" id="professor"><a class="viewcode-back" href="../../chapman.html#chapman.examples.professor">[docs]</a><span class="k">def</span> <span class="nf">professor</span><span class="p">(</span><span class="n">p_morning</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">p_afternoon</span> <span class="o">=</span> <span class="mf">0.20</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Markov chain with the professor and umbrellas.</span>

<span class="sd">    Args:</span>
<span class="sd">        p_morning (float): probability of raining in the morning. Defaults</span>
<span class="sd">            to 0.05.</span>
<span class="sd">        p_afternoon (float): probability of raining in the afternoon.</span>
<span class="sd">            Defaults to 0.2.</span>

<span class="sd">    Returns: </span>
<span class="sd">        a MarkovChain object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># constants</span>
    <span class="n">q_morning</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">p_morning</span>
    <span class="n">q_afternoon</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">p_afternoon</span>
    <span class="n">p_morning_label</span> <span class="o">=</span> <span class="s2">&quot;p_m&quot;</span>
    <span class="n">q_morning_label</span> <span class="o">=</span> <span class="s2">&quot;q_m&quot;</span>
    <span class="n">p_afternoon_label</span> <span class="o">=</span> <span class="s2">&quot;p_a&quot;</span>
    <span class="n">q_afternoon_label</span> <span class="o">=</span> <span class="s2">&quot;q_a&quot;</span>
    
    
    <span class="n">m</span> <span class="o">=</span> <span class="n">MarkovChain</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;professor&quot;</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">m</span>
    
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span> <span class="n">p</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    
    <span class="c1"># absorbing states get a different color and a loop direction</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;H5&quot;</span><span class="p">,</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;O5&quot;</span><span class="p">,</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
    
    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="s2">&quot;H5&quot;</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="s2">&quot;O5&quot;</span><span class="p">,</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    
    <span class="c1"># add edges to g</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">init</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">term</span> <span class="o">=</span> <span class="s2">&quot;O&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">term</span><span class="p">,</span> 
                <span class="n">probability</span><span class="o">=</span><span class="n">q_morning</span><span class="p">,</span> 
                <span class="n">label</span><span class="o">=</span><span class="n">q_morning_label</span><span class="p">,</span> 
                <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">init</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">term</span> <span class="o">=</span> <span class="s2">&quot;O&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">term</span><span class="p">,</span> 
                    <span class="n">probability</span><span class="o">=</span><span class="n">p_morning</span><span class="p">,</span> 
                    <span class="n">label</span><span class="o">=</span><span class="n">p_morning_label</span><span class="p">,</span> 
                    <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
    
        <span class="n">init</span> <span class="o">=</span> <span class="s2">&quot;O&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">term</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">term</span><span class="p">,</span> 
                <span class="n">probability</span><span class="o">=</span><span class="n">q_afternoon</span><span class="p">,</span> 
                <span class="n">label</span><span class="o">=</span><span class="n">q_afternoon_label</span><span class="p">,</span> 
                <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">init</span> <span class="o">=</span> <span class="s2">&quot;O&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">term</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">term</span><span class="p">,</span> 
                    <span class="n">probability</span><span class="o">=</span><span class="n">p_afternoon</span><span class="p">,</span> 
                    <span class="n">label</span><span class="o">=</span><span class="n">p_afternoon_label</span><span class="p">,</span> 
                    <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
    
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;H0&quot;</span><span class="p">,</span> <span class="s2">&quot;H5&quot;</span><span class="p">,</span> 
            <span class="n">probability</span><span class="o">=</span><span class="n">p_morning</span><span class="p">,</span> 
            <span class="n">label</span><span class="o">=</span><span class="n">p_morning_label</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;O0&quot;</span><span class="p">,</span> <span class="s2">&quot;O5&quot;</span><span class="p">,</span> 
            <span class="n">probability</span><span class="o">=</span><span class="n">p_afternoon</span><span class="p">,</span> 
            <span class="n">label</span><span class="o">=</span><span class="n">p_afternoon_label</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;H5&quot;</span><span class="p">,</span> <span class="s2">&quot;H5&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;O5&quot;</span><span class="p">,</span> <span class="s2">&quot;O5&quot;</span><span class="p">)</span>
    
    <span class="c1"># make arrow between O2 and H2 curve a bit more</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_curve</span><span class="p">(</span><span class="s2">&quot;O2&quot;</span><span class="p">,</span><span class="s2">&quot;H2&quot;</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_curve</span><span class="p">(</span><span class="s2">&quot;H2&quot;</span><span class="p">,</span><span class="s2">&quot;O2&quot;</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
    
    <span class="c1"># Layout</span>
    
    <span class="n">manual_layout</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;H5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;H0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;O4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> 
            <span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;O3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;H3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;O1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> 
            <span class="s1">&#39;H4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;O0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;O5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">}</span>

    <span class="n">m</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">the_layout</span> <span class="o">=</span> <span class="n">_rotate_scale_translate</span><span class="p">(</span><span class="n">manual_layout</span><span class="p">,</span> 
            <span class="n">stretch_x</span> <span class="o">=</span>  <span class="mi">10</span><span class="p">,</span> <span class="n">stretch_y</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
            <span class="n">move_x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">move_y</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_layout</span><span class="p">(</span><span class="n">the_layout</span><span class="p">)</span>
    
    <span class="c1"># last minute tweaks</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s2">&quot;H5&quot;</span><span class="p">,</span><span class="s2">&quot;Hw&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s2">&quot;O5&quot;</span><span class="p">,</span><span class="s2">&quot;Ow&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Hw&quot;</span><span class="p">,</span><span class="s2">&quot;Hw&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Ow&quot;</span><span class="p">,</span><span class="s2">&quot;Ow&quot;</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="tennis"><a class="viewcode-back" href="../../chapman.html#chapman.examples.tennis">[docs]</a><span class="k">def</span> <span class="nf">tennis</span><span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The tennis chain.</span>

<span class="sd">    Args:</span>
<span class="sd">        p (float): the probability that S wins in a single rally</span>

<span class="sd">    Returns: </span>
<span class="sd">        a MarkovChain object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">MarkovChain</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;tennis&quot;</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">m</span>

    <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;15&quot;</span><span class="p">,</span><span class="s2">&quot;30&quot;</span><span class="p">,</span><span class="s2">&quot;40&quot;</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span> <span class="ow">and</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">+</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s2">&quot;$S_</span><span class="si">{win}</span><span class="s2">$&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s2">&quot;$R_</span><span class="si">{win}</span><span class="s2">$&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span> <span class="ow">and</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">+</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>
    
    
    <span class="c1"># BUILDING THE GRAPH</span>
    <span class="n">nodes_game</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">nodes_other</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="p">]</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes_game</span><span class="o">+</span><span class="n">nodes_other</span>
    
    <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">clr</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
        <span class="k">if</span> <span class="n">nd</span> <span class="o">==</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">nd</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]:</span>
            <span class="n">clr</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">name</span><span class="p">(</span><span class="n">nd</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">(</span><span class="n">nd</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">)</span>
   
    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="n">name</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="n">name</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>

    <span class="n">p_label</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span>
    <span class="n">q_label</span> <span class="o">=</span> <span class="s1">&#39;q&#39;</span>
    <span class="n">q</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)),</span> <span class="n">name</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)),</span>
                        <span class="n">label</span><span class="o">=</span><span class="n">p_label</span><span class="p">,</span> <span class="n">probability</span> <span class="o">=</span> <span class="n">p</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)),</span> <span class="n">name</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span>
                        <span class="n">label</span><span class="o">=</span><span class="n">p_label</span><span class="p">,</span> <span class="n">probability</span> <span class="o">=</span> <span class="n">p</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span> 
                <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)),</span> <span class="n">name</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span>
                        <span class="n">label</span><span class="o">=</span><span class="n">q_label</span><span class="p">,</span> <span class="n">probability</span> <span class="o">=</span> <span class="n">q</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)),</span> <span class="n">name</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span>
                        <span class="n">label</span><span class="o">=</span><span class="n">q_label</span><span class="p">,</span> <span class="n">probability</span> <span class="o">=</span> <span class="n">q</span><span class="p">)</span>

    <span class="c1"># advantages back and forth</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="n">name</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>
            <span class="n">label</span><span class="o">=</span><span class="n">q_label</span><span class="p">,</span> <span class="n">curve</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="n">name</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
            <span class="n">label</span><span class="o">=</span><span class="n">p_label</span><span class="p">,</span> <span class="n">curve</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="n">name</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
            <span class="n">label</span><span class="o">=</span><span class="n">q_label</span><span class="p">,</span> <span class="n">curve</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span><span class="n">name</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
            <span class="n">label</span><span class="o">=</span><span class="n">p_label</span><span class="p">,</span> <span class="n">curve</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    
    <span class="c1"># wins</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span><span class="n">name</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span>
            <span class="n">label</span><span class="o">=</span><span class="n">q_label</span><span class="p">,</span>  <span class="n">probability</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="n">name</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span>
            <span class="n">label</span><span class="o">=</span><span class="n">p_label</span><span class="p">,</span>  <span class="n">probability</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span><span class="n">name</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">name</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span><span class="n">name</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
    
    
    <span class="c1"># Layout</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="mi">160</span><span class="p">,</span><span class="mi">110</span><span class="p">)</span>
    <span class="n">pre_layout</span> <span class="o">=</span>  <span class="n">nx</span><span class="o">.</span><span class="n">kamada_kawai_layout</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">the_layout</span> <span class="o">=</span> <span class="n">_rotate_scale_translate</span><span class="p">(</span><span class="n">pre_layout</span><span class="p">,</span> 
            <span class="n">angle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">104</span><span class="p">,</span> <span class="n">stretch_x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">stretch_y</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
            <span class="n">move_x</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">move_y</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_layout</span><span class="p">(</span><span class="n">the_layout</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></div>


<span class="c1"># def mc10_5_6():</span>
    <span class="c1"># &quot;&quot;&quot;The chain used in problem 10.5.6&quot;&quot;&quot;</span>

    <span class="c1"># m = MarkovChain(title = &quot;MC10_5_6&quot;)</span>
    <span class="c1"># states = [ str(i) for i in range(1,8) ]</span>
    <span class="c1"># for s in states:</span>
        <span class="c1"># m.add_state(s)</span>

    <span class="c1"># transitions = [</span>
            <span class="c1"># (1,2,0.5),</span>
            <span class="c1"># (1,3,0.5),</span>
            <span class="c1"># (2,1,1),</span>
            <span class="c1"># (3,1,0.5),</span>
            <span class="c1"># (3,2,0.5),</span>
            <span class="c1"># (4,3,0.25),</span>
            <span class="c1"># (4,5,0.5),</span>
            <span class="c1"># (4,6,0.25),</span>
            <span class="c1"># (5,6,1),</span>
            <span class="c1"># (6,6,0.5),</span>
            <span class="c1"># (6,7,0.5),</span>
            <span class="c1"># (7,6,1) ]</span>


    <span class="c1"># for i1,i2,p in transitions:</span>
        <span class="c1"># if p == 0.5:</span>
            <span class="c1"># lb = &quot;1/2&quot;</span>
        <span class="c1"># elif p == 0.25:</span>
            <span class="c1"># lb = &quot;1/4&quot;</span>
        <span class="c1"># else:</span>
            <span class="c1"># lb = str(p)</span>

        <span class="c1"># m.add_transition(str(i1), str(i2), probability = p, label = lb)</span>

    <span class="c1"># curves = [</span>
            <span class="c1"># (6,7),</span>
            <span class="c1"># (7,6), </span>
            <span class="c1"># (1,3),</span>
            <span class="c1"># (3,1),</span>
            <span class="c1"># (1,2),</span>
            <span class="c1"># (2,1)]</span>

    <span class="c1"># for i1,i2 in curves:</span>
        <span class="c1"># m.set_curve(str(i1), str(i2), 0.15)</span>

    <span class="c1"># m.set_loop_direction(&quot;6&quot;,&quot;ul&quot;)</span>
    <span class="c1"># m.compute()</span>

    <span class="c1"># # Layout</span>
    <span class="c1"># ###############</span>
    <span class="c1"># m.set_canvas(180,120)</span>
    <span class="c1"># pre_layout = nx.kamada_kawai_layout(m, weight = 1)</span>
    <span class="c1"># layout = _rotate_scale_translate(pre_layout, angle = 20, </span>
             <span class="c1"># stretch_x = 2, stretch_y = 2)</span>
    <span class="c1"># m.set_layout(layout)</span>
    <span class="c1"># return(m) </span>

<span class="c1"># def mc10_5_3(p=0.4, a=6):</span>
    <span class="c1"># &quot;&quot;&quot;The chain used in the problem 10.5.6</span>
    
    <span class="c1"># Args:</span>
        <span class="c1"># p (float): the probability that of a single win </span>
        <span class="c1"># a (int): the amount required to exit</span>

    <span class="c1"># Returns: </span>
        <span class="c1"># a MarkovChain object</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="c1"># m = MarkovChain(title = &quot;MC10_5_3&quot;)</span>
    <span class="c1"># states = [ str(i) for i in range(a+1) ]</span>
    <span class="c1"># for s in states:</span>
        <span class="c1"># m.add_state(s)</span>

    <span class="c1"># m.add_transition(&quot;0&quot;,&quot;0&quot;)</span>
    <span class="c1"># m.add_transition(str(a),str(a))</span>
    <span class="c1"># m.set_loop_direction(&quot;0&quot;,&quot;u&quot;) </span>
    <span class="c1"># m.set_loop_direction(str(a),&quot;r&quot;) </span>
    <span class="c1"># for i in range(1,a):</span>
        <span class="c1"># j = min( i, a-i)</span>
        <span class="c1"># m.add_transition(str(i),str(i-j),probability = 1-p, label = &quot;q&quot;)</span>
        <span class="c1"># m.add_transition(str(i),str(i+j),probability = p, label = &quot;p&quot;)</span>

    <span class="c1"># _curve_doubles(m)</span>
    <span class="c1"># m.compute()</span>

    <span class="c1"># # Layout</span>
    <span class="c1"># ###############</span>
    <span class="c1"># m.set_canvas(180,120)</span>
    <span class="c1"># pre_layout = graphviz_layout(m, prog=&quot;dot&quot;, args = &quot;-GNodesep=0.1&quot;)</span>
    <span class="c1"># pre_layout = nx.shell_layout(m, [[&quot;2&quot;,&quot;4&quot;],[&quot;0&quot;,&quot;1&quot;,&quot;3&quot;,&quot;5&quot;]])</span>
    <span class="c1"># layout = _rotate_scale_translate(pre_layout, angle = 0, </span>
             <span class="c1"># stretch_x = 2, stretch_y = 2)</span>
    <span class="c1"># m.set_layout(layout)</span>
    <span class="c1"># return(m) </span>

<span class="c1"># def mc10_5_1():</span>

    <span class="c1"># m = MarkovChain(title = &quot;MC10_5_1&quot;)</span>
    <span class="c1"># for i in range(1,8):</span>
        <span class="c1"># m.add_state(str(i))</span>

    <span class="c1"># trs = [</span>
            <span class="c1"># (1,1,0.5),</span>
            <span class="c1"># (1,3,0.5),</span>
            <span class="c1"># (2,1,0.25),</span>
            <span class="c1"># (2,2,0.5),</span>
            <span class="c1"># (2,3,0.25),</span>
            <span class="c1"># (3,2,0.5),</span>
            <span class="c1"># (3,3,0.5),</span>
            <span class="c1"># (4,3,1),</span>
            <span class="c1"># (5,4,0.5),</span>
            <span class="c1"># (5,6,0.5),</span>
            <span class="c1"># (6,7,1),</span>
            <span class="c1"># (7,6,0.5),</span>
            <span class="c1"># (7,7,0.5)</span>
            <span class="c1"># ]</span>

    <span class="c1"># for i1,i2,p in trs:</span>
        <span class="c1"># m.add_transition(str(i1), str(i2), probability = p)</span>

    <span class="c1"># m.compute()</span>
    
    
    <span class="c1"># m.set_loop_direction(&quot;1&quot;,&quot;r&quot;)</span>
    <span class="c1"># m.set_loop_direction(&quot;2&quot;,&quot;l&quot;)</span>
    <span class="c1"># m.set_loop_direction(&quot;3&quot;,&quot;u&quot;)</span>
    <span class="c1"># m.set_loop_direction(&quot;7&quot;,&quot;l&quot;)</span>

    <span class="c1"># _curve_doubles(m)</span>

    <span class="c1"># # Layout</span>
    <span class="c1"># ###############</span>
    <span class="c1"># m.set_canvas(180,100)</span>
    <span class="c1"># pre_layout = nx.kamada_kawai_layout(m, weight = 1)</span>
    <span class="c1"># pre_layout = graphviz_layout(m, prog=&quot;dot&quot;, args = &quot;-GNodesep=0.1&quot;)</span>
    <span class="c1"># layout = _rotate_scale_translate(pre_layout, angle = 90, </span>
             <span class="c1"># stretch_x = 2, stretch_y = 2)</span>
    <span class="c1"># m.set_layout(layout)</span>
    <span class="c1"># return(m)</span>


<span class="c1"># def story():</span>
    <span class="c1"># &quot;&quot;&quot;The chain used in the problem 10.5.6</span>

    <span class="c1"># Args:</span>
        <span class="c1"># p (float): the probability that of a single win </span>
        <span class="c1"># a (int): the amount required to exit</span>

    <span class="c1"># Returns: </span>
        <span class="c1"># a MarkovChain object</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="c1"># m = MarkovChain(title=&quot;story-01&quot;)</span>
    
    <span class="c1"># m.add_state(&quot;22&quot;,label=&quot;{2,2}&quot;);</span>
    <span class="c1"># m.add_state(&quot;21b&quot;,label=&quot;{2,1,b}&quot;);</span>
    <span class="c1"># m.add_state(&quot;12r&quot;,label=&quot;{1,2,r}&quot;);</span>
    <span class="c1"># m.add_state(&quot;11r&quot;,label=&quot;{1,1,r}&quot;);</span>
    <span class="c1"># m.add_state(&quot;11b&quot;,label=&quot;{1,1,b}&quot;);</span>
    <span class="c1"># m.add_state(&quot;02r&quot;,label=&quot;{0,2,r}&quot;);</span>
    <span class="c1"># m.add_state(&quot;01r&quot;,label=&quot;{0,1,r}&quot;);</span>
    <span class="c1"># m.add_state(&quot;10b&quot;,label=&quot;{1,0,b}&quot;);</span>
    <span class="c1"># m.add_state(&quot;01b&quot;,label=&quot;{0,1,b}&quot;);</span>
    <span class="c1"># m.add_state(&quot;00&quot;,label=&quot;{0,0}&quot;);</span>


    <span class="c1"># m.add_transition(&quot;22&quot;,&quot;21b&quot;,probability = 0.5, label=&quot;1/2&quot;);</span>
    <span class="c1"># m.add_transition(&quot;22&quot;,&quot;12r&quot;,probability = 0.5, label=&quot;1/2&quot;);</span>
    <span class="c1"># m.add_transition(&quot;21b&quot;,&quot;21b&quot;,probability = 1/3, label=&quot;1/3&quot;);</span>
    <span class="c1"># m.add_transition(&quot;21b&quot;,&quot;11r&quot;,probability = 2/3, label=&quot;2/3&quot;);</span>
    <span class="c1"># m.add_transition(&quot;12r&quot;,&quot;11b&quot;,probability = 2/3, label=&quot;2/3&quot;);</span>
    <span class="c1"># m.add_transition(&quot;12r&quot;,&quot;02r&quot;,probability = 1/3, label=&quot;1/3&quot;); </span>
    <span class="c1"># m.add_transition(&quot;11r&quot;,&quot;01r&quot;,probability = 0.5, label=&quot;1/2&quot;);</span>
    <span class="c1"># m.add_transition(&quot;11r&quot;,&quot;10b&quot;,probability = 0.5, label=&quot;1/2&quot;); #</span>
    <span class="c1"># m.add_transition(&quot;11b&quot;,&quot;11b&quot;,probability = 0.5, label=&quot;1/2&quot;);</span>
    <span class="c1"># m.add_transition(&quot;11b&quot;,&quot;01r&quot;,probability = 0.5, label=&quot;1/2&quot;);</span>
    <span class="c1"># m.add_transition(&quot;02r&quot;,&quot;01b&quot;,probability = 1, label=&quot;1&quot;);</span>
    <span class="c1"># m.add_transition(&quot;01r&quot;,&quot;00&quot;,probability = 1, label=&quot;1&quot;);</span>
    <span class="c1"># m.add_transition(&quot;10b&quot;,&quot;00&quot;,probability = 1, label=&quot;1&quot;);</span>
    <span class="c1"># m.add_transition(&quot;01b&quot;,&quot;01b&quot;,probability = 1, label=&quot;1&quot;);</span>
    <span class="c1"># m.add_transition(&quot;00&quot;,&quot;00&quot;,probability = 1, label=&quot;1&quot;);</span>

    <span class="c1"># m.set_loop_direction(&quot;21b&quot;,&quot;-60&quot;)</span>
    <span class="c1"># m.set_loop_direction(&quot;11b&quot;,&quot;d&quot;)</span>



    <span class="c1"># m.compute();</span>

    <span class="c1"># # Layout</span>
    <span class="c1"># ###############</span>
    <span class="c1"># m.set_canvas(180,110)</span>
    <span class="c1"># pre_layout = graphviz_layout(m, prog=&quot;dot&quot;, args = &quot;-GNodesep=2&quot;)</span>
    <span class="c1"># layout = _rotate_scale_translate(pre_layout, angle = -90)</span>
    <span class="c1"># m.set_layout(layout)</span>
    <span class="c1"># return(m)</span>


<span class="k">def</span> <span class="nf">_largest_initial</span><span class="p">(</span><span class="n">sofar</span><span class="p">,</span> <span class="n">pat</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sofar</span><span class="p">),</span> <span class="s2">&quot;Something wrong.&quot;</span>
    <span class="k">if</span> <span class="n">pat</span> <span class="o">==</span> <span class="n">sofar</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">pat</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sofar</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">p</span><span class="p">[:(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))]:</span>
                <span class="k">break</span>
            <span class="n">s</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">bigger</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sofar</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">bigger</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

<div class="viewcode-block" id="patterns"><a class="viewcode-back" href="../../chapman.html#chapman.examples.patterns">[docs]</a><span class="k">def</span> <span class="nf">patterns</span><span class="p">(</span><span class="n">pat</span> <span class="o">=</span> <span class="s2">&quot;HTH&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A chain used to analyze coin-tossing patterns</span>

<span class="sd">    Args:</span>
<span class="sd">        pat (str): a string pattern consisting of Hs and Ts</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">m</span><span class="o">=</span><span class="n">MarkovChain</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Patterns&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">)):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">pat</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">),</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span><span class="n">pat</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">states</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span> <span class="o">==</span> <span class="n">pat</span><span class="p">:</span>
            <span class="n">biggerT</span><span class="p">,</span> <span class="n">sT</span> <span class="o">=</span> <span class="n">_largest_initial</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="p">)</span>
            <span class="n">biggerH</span><span class="p">,</span> <span class="n">sH</span> <span class="o">=</span> <span class="n">_largest_initial</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="n">pat</span><span class="p">)</span>
            <span class="n">extraT</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="o">-</span>  <span class="nb">len</span><span class="p">(</span><span class="n">sT</span><span class="p">)</span> 
            <span class="n">extraH</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="o">-</span>  <span class="nb">len</span><span class="p">(</span><span class="n">sH</span><span class="p">)</span> 
            <span class="k">if</span> <span class="n">biggerT</span><span class="p">:</span> <span class="n">extraT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">if</span> <span class="n">biggerH</span><span class="p">:</span> <span class="n">extraH</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">sT</span><span class="p">,</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;1/2&quot;</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">extraT</span><span class="p">))</span>
            <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">sH</span><span class="p">,</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;1/2&quot;</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">extraH</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span><span class="s2">&quot;Win&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Win&quot;</span><span class="p">,</span><span class="s2">&quot;Win&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">states</span><span class="p">():</span>
        <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">pat</span><span class="p">),</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">_curve_doubles</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></div>

<div class="viewcode-block" id="patterns_HHH"><a class="viewcode-back" href="../../chapman.html#chapman.examples.patterns_HHH">[docs]</a><span class="k">def</span> <span class="nf">patterns_HHH</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;A chain used to analyze coin-tossing patterns&quot;&quot;&quot;</span>

    <span class="n">m</span><span class="o">=</span><span class="n">MarkovChain</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Patterns&quot;</span><span class="p">)</span>
    <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;H&quot;</span><span class="p">,</span><span class="s2">&quot;HH&quot;</span><span class="p">,</span><span class="s2">&quot;Win&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">states</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add_state</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;Win&quot;</span><span class="p">,</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">probability</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;1/2&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;H&quot;</span><span class="p">,</span><span class="n">probability</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;1/2&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="n">probability</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;1/2&quot;</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span><span class="s2">&quot;HH&quot;</span><span class="p">,</span><span class="n">probability</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;1/2&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;HH&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="n">probability</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;1/2&quot;</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;HH&quot;</span><span class="p">,</span><span class="s2">&quot;Win&quot;</span><span class="p">,</span><span class="n">probability</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;1/2&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_transition</span><span class="p">(</span><span class="s2">&quot;Win&quot;</span><span class="p">,</span><span class="s2">&quot;Win&quot;</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_loop_direction</span><span class="p">(</span><span class="s2">&quot;Win&quot;</span><span class="p">,</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">chapman</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chapman.html">Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Gordan Zitkovic.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>